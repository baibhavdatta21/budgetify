2024-10-26 01:21:37,057 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:21:37,057 - INFO - Available functions in util: ['__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', 'clear_logs', 'log_info', 'logging', 'os', 'pd', 'set_up_logging']
2024-10-26 01:21:37,058 - INFO - ['.git', '.gitignore', '.venv', 'app.logs', 'Backend_config', 'config.json', 'Data_Dictionary.csv', 'Data_Flow.png', 'data_load.py', 'DDL', 'FY_2024_25.xlsx', 'Generate_insights.py', 'Mock_data_fy_24_25.xlsx', 'REPORTS', 'Run_tut.txt', 'script.py', 'Sql_Analysis', 'util.py', 'venv', 'views', '__pycache__', '~$Mock_data_fy_24_25.xlsx']
2024-10-26 01:21:37,141 - INFO - Connection Established Successfully!!
2024-10-26 01:21:37,146 - INFO - Schema Check : ('finance_insights_stg',)
2024-10-26 01:21:37,146 - INFO - Schema 'finance_insights_stg' already exists !!
2024-10-26 01:21:37,147 - INFO - C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\Mock_data_fy_24_25.xlsx
2024-10-26 01:21:37,524 - INFO - sheets found : ['April_2024', 'May_2024', 'June_2024', 'July_2024', 'August_2024', 'September_2024', 'October_2024']
2024-10-26 01:21:37,571 - INFO - Reading Sheet : April_2024
2024-10-26 01:21:37,602 - INFO - File has been saved as :april_2024.csv 
2024-10-26 01:21:37,616 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.april_2024;
2024-10-26 01:21:37,617 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount FLOAT', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,617 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.april_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount FLOAT, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,629 - INFO - DDL of Table april_2024 Created Successfully!!
2024-10-26 01:21:37,629 - INFO - #########################
2024-10-26 01:21:37,650 - INFO - Reading Sheet : May_2024
2024-10-26 01:21:37,654 - INFO - File has been saved as :may_2024.csv 
2024-10-26 01:21:37,659 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.may_2024;
2024-10-26 01:21:37,659 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount FLOAT', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,659 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.may_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount FLOAT, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,666 - INFO - DDL of Table may_2024 Created Successfully!!
2024-10-26 01:21:37,666 - INFO - #########################
2024-10-26 01:21:37,690 - INFO - Reading Sheet : June_2024
2024-10-26 01:21:37,695 - INFO - File has been saved as :june_2024.csv 
2024-10-26 01:21:37,700 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.june_2024;
2024-10-26 01:21:37,701 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount INTEGER', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,701 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.june_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount INTEGER, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,708 - INFO - DDL of Table june_2024 Created Successfully!!
2024-10-26 01:21:37,708 - INFO - #########################
2024-10-26 01:21:37,732 - INFO - Reading Sheet : July_2024
2024-10-26 01:21:37,736 - INFO - File has been saved as :july_2024.csv 
2024-10-26 01:21:37,742 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.july_2024;
2024-10-26 01:21:37,742 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount FLOAT', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,742 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.july_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount FLOAT, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,751 - INFO - DDL of Table july_2024 Created Successfully!!
2024-10-26 01:21:37,751 - INFO - #########################
2024-10-26 01:21:37,778 - INFO - Reading Sheet : August_2024
2024-10-26 01:21:37,781 - INFO - File has been saved as :august_2024.csv 
2024-10-26 01:21:37,787 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.august_2024;
2024-10-26 01:21:37,788 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount FLOAT', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,788 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.august_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount FLOAT, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,796 - INFO - DDL of Table august_2024 Created Successfully!!
2024-10-26 01:21:37,796 - INFO - #########################
2024-10-26 01:21:37,839 - INFO - Reading Sheet : September_2024
2024-10-26 01:21:37,843 - INFO - File has been saved as :september_2024.csv 
2024-10-26 01:21:37,851 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.september_2024;
2024-10-26 01:21:37,851 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount INTEGER', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,852 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.september_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount INTEGER, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,861 - INFO - DDL of Table september_2024 Created Successfully!!
2024-10-26 01:21:37,861 - INFO - #########################
2024-10-26 01:21:37,887 - INFO - Reading Sheet : October_2024
2024-10-26 01:21:37,889 - INFO - File has been saved as :october_2024.csv 
2024-10-26 01:21:37,894 - INFO - Executing Drop DDL query: DROP TABLE finance_insights_stg.october_2024;
2024-10-26 01:21:37,895 - INFO - Columsdef are ['expense_category VARCHAR(200)', 'expense_description VARCHAR(200)', 'expected_budget INTEGER', 'amount FLOAT', 'payment_status VARCHAR(200)', 'payment_mode VARCHAR(200)', 'financial_category VARCHAR(200)', 'transaction_type VARCHAR(200)', 'record_date TIMESTAMP', 'currency VARCHAR(200)']
2024-10-26 01:21:37,895 - INFO - Creating table with query: CREATE TABLE IF NOT EXISTS finance_insights_stg.october_2024 (expense_category VARCHAR(200), expense_description VARCHAR(200), expected_budget INTEGER, amount FLOAT, payment_status VARCHAR(200), payment_mode VARCHAR(200), financial_category VARCHAR(200), transaction_type VARCHAR(200), record_date TIMESTAMP, currency VARCHAR(200));
2024-10-26 01:21:37,900 - INFO - DDL of Table october_2024 Created Successfully!!
2024-10-26 01:21:37,900 - INFO - #########################
2024-10-26 01:21:37,905 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:37,905 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,923 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:37,926 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,933 - INFO - Data for april_2024.csv copied successfully
2024-10-26 01:21:37,934 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\april_2024.csv has been  deleted successfully
2024-10-26 01:21:37,934 - INFO - ########################
2024-10-26 01:21:37,938 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:37,938 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,941 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:37,945 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,947 - INFO - Data for august_2024.csv copied successfully
2024-10-26 01:21:37,948 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\august_2024.csv has been  deleted successfully
2024-10-26 01:21:37,948 - INFO - ########################
2024-10-26 01:21:37,951 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:37,951 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,954 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:37,957 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,960 - INFO - Data for july_2024.csv copied successfully
2024-10-26 01:21:37,961 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\july_2024.csv has been  deleted successfully
2024-10-26 01:21:37,961 - INFO - ########################
2024-10-26 01:21:37,972 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:37,972 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,975 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:37,977 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,980 - INFO - Data for june_2024.csv copied successfully
2024-10-26 01:21:37,980 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\june_2024.csv has been  deleted successfully
2024-10-26 01:21:37,980 - INFO - ########################
2024-10-26 01:21:37,984 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:37,984 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,987 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:37,989 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,992 - INFO - Data for may_2024.csv copied successfully
2024-10-26 01:21:37,992 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\may_2024.csv has been  deleted successfully
2024-10-26 01:21:37,992 - INFO - ########################
2024-10-26 01:21:37,996 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:37,996 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:37,999 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:38,002 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:38,006 - INFO - Data for october_2024.csv copied successfully
2024-10-26 01:21:38,006 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\october_2024.csv has been  deleted successfully
2024-10-26 01:21:38,007 - INFO - ########################
2024-10-26 01:21:38,010 - INFO - The number of columns in df_csv is : 10
2024-10-26 01:21:38,010 - INFO - The list of columns present in the csv files are  : ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:38,014 - INFO - Number of columns in PostgreSQL table 'finance_insights_stg.october_2024': 10
2024-10-26 01:21:38,016 - INFO - All columns in PostgreSQL table 'finance_insights_stg.october_2024': ['expense_category', 'expense_description', 'expected_budget', 'amount', 'payment_status', 'payment_mode', 'financial_category', 'transaction_type', 'record_date', 'currency']
2024-10-26 01:21:38,019 - INFO - Data for september_2024.csv copied successfully
2024-10-26 01:21:38,020 - INFO - Temporary file C:/Users/shogu/OneDrive/Desktop/Data Engineering/FY_Data_analysis\september_2024.csv has been  deleted successfully
2024-10-26 01:21:38,020 - INFO - ########################
2024-10-26 01:21:46,555 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:21:46,555 - INFO - ###############
2024-10-26 01:21:46,555 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:21:46,555 - INFO - Data Integration from finance_insights_stg to finance_insights_int is in progress
2024-10-26 01:21:46,624 - INFO - ###########all tables
2024-10-26 01:21:46,634 - INFO - ######Batch loading from finance_insights_stg to finance_insights_int in Progress !!
2024-10-26 01:21:46,634 - INFO - Fetching all the tables from current schema  : finance_insights_stg 
2024-10-26 01:21:46,635 - INFO - [('november_2024',), ('april_2024',), ('may_2024',), ('june_2024',), ('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',)]
2024-10-26 01:21:46,635 - INFO - #############################
2024-10-26 01:21:46,636 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,638 - INFO - Table finance_insights_int.november_2024 already exists !! 
2024-10-26 01:21:46,638 - INFO - Dropping off the table
2024-10-26 01:21:46,639 - INFO - Creating ddl for finance_insights_int.november_2024
2024-10-26 01:21:46,653 - INFO - #############################
2024-10-26 01:21:46,655 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,656 - INFO - Table finance_insights_int.april_2024 already exists !! 
2024-10-26 01:21:46,656 - INFO - Dropping off the table
2024-10-26 01:21:46,656 - INFO - Creating ddl for finance_insights_int.april_2024
2024-10-26 01:21:46,664 - INFO - Target table : finance_insights_int.april_2024 created successfully !!
2024-10-26 01:21:46,665 - INFO - Data copied from finance_insights_stg.april_2024 to finance_insights_int.april_2024 successful!!!
2024-10-26 01:21:46,665 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,665 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,674 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,679 - INFO - Changes made successfully!!
2024-10-26 01:21:46,680 - INFO - #############################
2024-10-26 01:21:46,681 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,682 - INFO - Table finance_insights_int.may_2024 already exists !! 
2024-10-26 01:21:46,682 - INFO - Dropping off the table
2024-10-26 01:21:46,683 - INFO - Creating ddl for finance_insights_int.may_2024
2024-10-26 01:21:46,696 - INFO - Target table : finance_insights_int.may_2024 created successfully !!
2024-10-26 01:21:46,697 - INFO - Data copied from finance_insights_stg.may_2024 to finance_insights_int.may_2024 successful!!!
2024-10-26 01:21:46,698 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,698 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,705 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,710 - INFO - Changes made successfully!!
2024-10-26 01:21:46,710 - INFO - #############################
2024-10-26 01:21:46,711 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,712 - INFO - Table finance_insights_int.june_2024 already exists !! 
2024-10-26 01:21:46,712 - INFO - Dropping off the table
2024-10-26 01:21:46,713 - INFO - Creating ddl for finance_insights_int.june_2024
2024-10-26 01:21:46,724 - INFO - Target table : finance_insights_int.june_2024 created successfully !!
2024-10-26 01:21:46,725 - INFO - Data copied from finance_insights_stg.june_2024 to finance_insights_int.june_2024 successful!!!
2024-10-26 01:21:46,725 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,725 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,733 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,738 - INFO - Changes made successfully!!
2024-10-26 01:21:46,738 - INFO - #############################
2024-10-26 01:21:46,739 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,740 - INFO - Table finance_insights_int.july_2024 already exists !! 
2024-10-26 01:21:46,740 - INFO - Dropping off the table
2024-10-26 01:21:46,740 - INFO - Creating ddl for finance_insights_int.july_2024
2024-10-26 01:21:46,749 - INFO - Target table : finance_insights_int.july_2024 created successfully !!
2024-10-26 01:21:46,751 - INFO - Data copied from finance_insights_stg.july_2024 to finance_insights_int.july_2024 successful!!!
2024-10-26 01:21:46,751 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,751 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,758 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,763 - INFO - Changes made successfully!!
2024-10-26 01:21:46,763 - INFO - #############################
2024-10-26 01:21:46,764 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,765 - INFO - Table finance_insights_int.august_2024 already exists !! 
2024-10-26 01:21:46,765 - INFO - Dropping off the table
2024-10-26 01:21:46,765 - INFO - Creating ddl for finance_insights_int.august_2024
2024-10-26 01:21:46,775 - INFO - Target table : finance_insights_int.august_2024 created successfully !!
2024-10-26 01:21:46,776 - INFO - Data copied from finance_insights_stg.august_2024 to finance_insights_int.august_2024 successful!!!
2024-10-26 01:21:46,777 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,777 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,784 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,788 - INFO - Changes made successfully!!
2024-10-26 01:21:46,788 - INFO - #############################
2024-10-26 01:21:46,789 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,791 - INFO - Table finance_insights_int.september_2024 already exists !! 
2024-10-26 01:21:46,791 - INFO - Dropping off the table
2024-10-26 01:21:46,792 - INFO - Creating ddl for finance_insights_int.september_2024
2024-10-26 01:21:46,800 - INFO - Target table : finance_insights_int.september_2024 created successfully !!
2024-10-26 01:21:46,801 - INFO - Data copied from finance_insights_stg.september_2024 to finance_insights_int.september_2024 successful!!!
2024-10-26 01:21:46,801 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,802 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,808 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,813 - INFO - Changes made successfully!!
2024-10-26 01:21:46,813 - INFO - #############################
2024-10-26 01:21:46,814 - INFO - Checking if the target table already exists : 
2024-10-26 01:21:46,815 - INFO - Table finance_insights_int.october_2024 already exists !! 
2024-10-26 01:21:46,815 - INFO - Dropping off the table
2024-10-26 01:21:46,816 - INFO - Creating ddl for finance_insights_int.october_2024
2024-10-26 01:21:46,825 - INFO - Target table : finance_insights_int.october_2024 created successfully !!
2024-10-26 01:21:46,826 - INFO - Data copied from finance_insights_stg.october_2024 to finance_insights_int.october_2024 successful!!!
2024-10-26 01:21:46,827 - INFO - Temp table for file_nm insertion
2024-10-26 01:21:46,827 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:21:46,834 - INFO - file_nm insertion successfull
2024-10-26 01:21:46,839 - INFO - Changes made successfully!!
2024-10-26 01:22:02,682 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:22:02,682 - INFO - ###############
2024-10-26 01:22:02,682 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:22:02,682 - INFO - Data Integration from finance_insights_int to finance_insights_wrk is in progress
2024-10-26 01:22:02,776 - INFO - ###########all tables
2024-10-26 01:22:02,785 - INFO - ######Batch loading from finance_insights_int to finance_insights_wrk in Progress !!
2024-10-26 01:22:02,785 - INFO - Fetching all the tables from current schema  : finance_insights_int 
2024-10-26 01:22:02,785 - INFO - [('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',), ('april_2024',), ('may_2024',), ('june_2024',), ('november_2024',)]
2024-10-26 01:22:02,785 - INFO - Storing the views in a temp layer 
2024-10-26 01:22:02,843 - INFO - Droping the views for proper data load to wrk 
2024-10-26 01:22:02,846 - INFO - #############################
2024-10-26 01:22:02,847 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:02,849 - INFO - Table finance_insights_wrk.july_2024 already exists !! 
2024-10-26 01:22:02,850 - INFO - Dropping off the table
2024-10-26 01:22:02,850 - INFO - Creating ddl for finance_insights_wrk.july_2024
2024-10-26 01:22:02,860 - INFO - Target table : finance_insights_wrk.july_2024 created successfully !!
2024-10-26 01:22:02,861 - INFO - Data copied from finance_insights_int.july_2024 to finance_insights_wrk.july_2024 successful!!!
2024-10-26 01:22:02,861 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:02,861 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:02,870 - INFO - file_nm insertion successfull
2024-10-26 01:22:02,874 - INFO - Changes made successfully!!
2024-10-26 01:22:02,874 - INFO - #############################
2024-10-26 01:22:02,875 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:02,877 - INFO - Table finance_insights_wrk.august_2024 already exists !! 
2024-10-26 01:22:02,877 - INFO - Dropping off the table
2024-10-26 01:22:02,878 - INFO - Creating ddl for finance_insights_wrk.august_2024
2024-10-26 01:22:02,888 - INFO - Target table : finance_insights_wrk.august_2024 created successfully !!
2024-10-26 01:22:02,889 - INFO - Data copied from finance_insights_int.august_2024 to finance_insights_wrk.august_2024 successful!!!
2024-10-26 01:22:02,889 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:02,889 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:02,895 - INFO - file_nm insertion successfull
2024-10-26 01:22:02,899 - INFO - Changes made successfully!!
2024-10-26 01:22:02,899 - INFO - #############################
2024-10-26 01:22:02,901 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:02,902 - INFO - Table finance_insights_wrk.september_2024 already exists !! 
2024-10-26 01:22:02,902 - INFO - Dropping off the table
2024-10-26 01:22:02,902 - INFO - Creating ddl for finance_insights_wrk.september_2024
2024-10-26 01:22:02,912 - INFO - Target table : finance_insights_wrk.september_2024 created successfully !!
2024-10-26 01:22:02,914 - INFO - Data copied from finance_insights_int.september_2024 to finance_insights_wrk.september_2024 successful!!!
2024-10-26 01:22:02,914 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:02,914 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:02,921 - INFO - file_nm insertion successfull
2024-10-26 01:22:02,926 - INFO - Changes made successfully!!
2024-10-26 01:22:02,926 - INFO - #############################
2024-10-26 01:22:02,927 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:02,928 - INFO - Table finance_insights_wrk.october_2024 already exists !! 
2024-10-26 01:22:02,928 - INFO - Dropping off the table
2024-10-26 01:22:02,929 - INFO - Creating ddl for finance_insights_wrk.october_2024
2024-10-26 01:22:02,940 - INFO - Target table : finance_insights_wrk.october_2024 created successfully !!
2024-10-26 01:22:02,941 - INFO - Data copied from finance_insights_int.october_2024 to finance_insights_wrk.october_2024 successful!!!
2024-10-26 01:22:02,941 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:02,941 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:02,947 - INFO - file_nm insertion successfull
2024-10-26 01:22:02,952 - INFO - Changes made successfully!!
2024-10-26 01:22:02,952 - INFO - #############################
2024-10-26 01:22:02,953 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:02,954 - INFO - Table finance_insights_wrk.april_2024 already exists !! 
2024-10-26 01:22:02,954 - INFO - Dropping off the table
2024-10-26 01:22:02,955 - INFO - Creating ddl for finance_insights_wrk.april_2024
2024-10-26 01:22:02,964 - INFO - Target table : finance_insights_wrk.april_2024 created successfully !!
2024-10-26 01:22:02,966 - INFO - Data copied from finance_insights_int.april_2024 to finance_insights_wrk.april_2024 successful!!!
2024-10-26 01:22:02,966 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:02,966 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:02,973 - INFO - file_nm insertion successfull
2024-10-26 01:22:02,977 - INFO - Changes made successfully!!
2024-10-26 01:22:02,977 - INFO - #############################
2024-10-26 01:22:02,978 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:02,979 - INFO - Table finance_insights_wrk.may_2024 already exists !! 
2024-10-26 01:22:02,979 - INFO - Dropping off the table
2024-10-26 01:22:02,980 - INFO - Creating ddl for finance_insights_wrk.may_2024
2024-10-26 01:22:02,992 - INFO - Target table : finance_insights_wrk.may_2024 created successfully !!
2024-10-26 01:22:02,994 - INFO - Data copied from finance_insights_int.may_2024 to finance_insights_wrk.may_2024 successful!!!
2024-10-26 01:22:02,994 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:02,994 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:03,000 - INFO - file_nm insertion successfull
2024-10-26 01:22:03,005 - INFO - Changes made successfully!!
2024-10-26 01:22:03,005 - INFO - #############################
2024-10-26 01:22:03,006 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:03,007 - INFO - Table finance_insights_wrk.june_2024 already exists !! 
2024-10-26 01:22:03,007 - INFO - Dropping off the table
2024-10-26 01:22:03,007 - INFO - Creating ddl for finance_insights_wrk.june_2024
2024-10-26 01:22:03,021 - INFO - Target table : finance_insights_wrk.june_2024 created successfully !!
2024-10-26 01:22:03,022 - INFO - Data copied from finance_insights_int.june_2024 to finance_insights_wrk.june_2024 successful!!!
2024-10-26 01:22:03,022 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:03,022 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:03,030 - INFO - file_nm insertion successfull
2024-10-26 01:22:03,034 - INFO - Changes made successfully!!
2024-10-26 01:22:03,034 - INFO - #############################
2024-10-26 01:22:03,036 - INFO - Checking if the target table already exists : 
2024-10-26 01:22:03,037 - INFO - Table finance_insights_wrk.november_2024 already exists !! 
2024-10-26 01:22:03,037 - INFO - Dropping off the table
2024-10-26 01:22:03,037 - INFO - Creating ddl for finance_insights_wrk.november_2024
2024-10-26 01:22:03,048 - INFO - Target table : finance_insights_wrk.november_2024 created successfully !!
2024-10-26 01:22:03,050 - INFO - Data copied from finance_insights_int.november_2024 to finance_insights_wrk.november_2024 successful!!!
2024-10-26 01:22:03,050 - INFO - Temp table for file_nm insertion
2024-10-26 01:22:03,050 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:22:03,056 - INFO - file_nm insertion successfull
2024-10-26 01:22:03,061 - INFO - Changes made successfully!!
2024-10-26 01:22:03,062 - INFO - Recreating all the views !!
2024-10-26 01:22:31,438 - INFO - ###############
2024-10-26 01:22:31,439 - INFO - SQL TO EXCEL in Progress
2024-10-26 01:22:31,518 - INFO - DB Connected for SQL to Excel conversion.
2024-10-26 01:22:31,585 - INFO - Error executing SQL query: --1. "Savings Rate"
WITH fin_cte1 AS (
    SELECT 
        SUM(CASE WHEN transaction_type = 'investment' THEN amount ELSE 0 END) AS total_investment,
        SUM(CASE WHEN transaction_type = 'expense' THEN amount ELSE 0 END) AS total_expense
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    total_investment, 
    total_expense, 
    ROUND((total_investment::NUMERIC / NULLIF((total_investment + total_expense)::NUMERIC, 0) * 100)::NUMERIC, 2) AS savings_rate 
FROM fin_cte1
Execution failed on sql '--1. "Savings Rate"
WITH fin_cte1 AS (
    SELECT 
        SUM(CASE WHEN transaction_type = 'investment' THEN amount ELSE 0 END) AS total_investment,
        SUM(CASE WHEN transaction_type = 'expense' THEN amount ELSE 0 END) AS total_expense
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    total_investment, 
    total_expense, 
    ROUND((total_investment::NUMERIC / NULLIF((total_investment + total_expense)::NUMERIC, 0) * 100)::NUMERIC, 2) AS savings_rate 
FROM fin_cte1': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 6:     FROM finance_insights_wrk.ocotber_2024
                 ^

2024-10-26 01:22:31,586 - INFO - No data returned for query 1.
2024-10-26 01:22:31,590 - INFO - Error executing SQL query: -- 2. Recurring vs. Non-Recurring Expenses
SELECT 
    * 
FROM finance_insights_wrk.ocotber_2024
Execution failed on sql '-- 2. Recurring vs. Non-Recurring Expenses
SELECT 
    * 
FROM finance_insights_wrk.ocotber_2024': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 4: FROM finance_insights_wrk.ocotber_2024
             ^

2024-10-26 01:22:31,590 - INFO - No data returned for query 2.
2024-10-26 01:22:31,594 - INFO - Error executing SQL query: -- 3. Expense Efficiency: Needs vs Wants
WITH fin_cte2 AS (
    SELECT 
        SUM(CASE WHEN financial_category = 'needs' THEN amount ELSE 0 END) AS total_needs,
        SUM(CASE WHEN financial_category = 'invest' THEN amount ELSE 0 END) AS total_invest,
        SUM(CASE WHEN financial_category = 'wants' THEN amount ELSE 0 END) AS total_wants
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    total_needs, 
    total_invest, 
    total_wants, 
    ROUND((total_needs::NUMERIC / NULLIF((total_needs + total_wants + total_invest)::NUMERIC, 0) * 100)::NUMERIC, 2) AS needs_percentage,
    ROUND((total_invest::NUMERIC / NULLIF((total_needs + total_wants + total_invest)::NUMERIC, 0) * 100)::NUMERIC, 2) AS invest_percentage,
    ROUND((total_wants::NUMERIC / NULLIF((total_needs + total_wants + total_invest)::NUMERIC, 0) * 100)::NUMERIC, 2) AS wants_percentage
FROM fin_cte2
Execution failed on sql '-- 3. Expense Efficiency: Needs vs Wants
WITH fin_cte2 AS (
    SELECT 
        SUM(CASE WHEN financial_category = 'needs' THEN amount ELSE 0 END) AS total_needs,
        SUM(CASE WHEN financial_category = 'invest' THEN amount ELSE 0 END) AS total_invest,
        SUM(CASE WHEN financial_category = 'wants' THEN amount ELSE 0 END) AS total_wants
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    total_needs, 
    total_invest, 
    total_wants, 
    ROUND((total_needs::NUMERIC / NULLIF((total_needs + total_wants + total_invest)::NUMERIC, 0) * 100)::NUMERIC, 2) AS needs_percentage,
    ROUND((total_invest::NUMERIC / NULLIF((total_needs + total_wants + total_invest)::NUMERIC, 0) * 100)::NUMERIC, 2) AS invest_percentage,
    ROUND((total_wants::NUMERIC / NULLIF((total_needs + total_wants + total_invest)::NUMERIC, 0) * 100)::NUMERIC, 2) AS wants_percentage
FROM fin_cte2': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 7:     FROM finance_insights_wrk.ocotber_2024
                 ^

2024-10-26 01:22:31,595 - INFO - No data returned for query 3.
2024-10-26 01:22:31,597 - INFO - Error executing SQL query: -- 4. Daily Expense Comparison
-- Highest Daily Expense
SELECT 
    EXTRACT(DAY FROM record_date) AS day, 
    SUM(amount) AS daily_amount 
FROM finance_insights_wrk.ocotber_2024 
GROUP BY day 
ORDER BY daily_amount DESC 
LIMIT 1
Execution failed on sql '-- 4. Daily Expense Comparison
-- Highest Daily Expense
SELECT 
    EXTRACT(DAY FROM record_date) AS day, 
    SUM(amount) AS daily_amount 
FROM finance_insights_wrk.ocotber_2024 
GROUP BY day 
ORDER BY daily_amount DESC 
LIMIT 1': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 6: FROM finance_insights_wrk.ocotber_2024 
             ^

2024-10-26 01:22:31,599 - INFO - No data returned for query 4.
2024-10-26 01:22:31,603 - INFO - Error executing SQL query: --5. Lowest Daily Expense
SELECT 
    EXTRACT(DAY FROM record_date) AS day, 
    SUM(amount) AS daily_amount 
FROM finance_insights_wrk.ocotber_2024 
GROUP BY day 
ORDER BY daily_amount ASC 
LIMIT 1
Execution failed on sql '--5. Lowest Daily Expense
SELECT 
    EXTRACT(DAY FROM record_date) AS day, 
    SUM(amount) AS daily_amount 
FROM finance_insights_wrk.ocotber_2024 
GROUP BY day 
ORDER BY daily_amount ASC 
LIMIT 1': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 5: FROM finance_insights_wrk.ocotber_2024 
             ^

2024-10-26 01:22:31,604 - INFO - No data returned for query 5.
2024-10-26 01:22:31,607 - INFO - Error executing SQL query: --6. Weekly Analysis
WITH fin_cte3 AS (
    SELECT 
        expense_category,
        amount,
        record_date, 
        EXTRACT(DAY FROM record_date) AS day,
        CASE 
            WHEN EXTRACT(DAY FROM record_date) BETWEEN 1 AND 7 THEN 'week1'
            WHEN EXTRACT(DAY FROM record_date) BETWEEN 8 AND 14 THEN 'week2'
            WHEN EXTRACT(DAY FROM record_date) BETWEEN 15 AND 21 THEN 'week3'
            ELSE 'week4'
        END AS week
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    week, 
    SUM(amount) AS total_amount 
FROM fin_cte3 
GROUP BY week order by week asc
Execution failed on sql '--6. Weekly Analysis
WITH fin_cte3 AS (
    SELECT 
        expense_category,
        amount,
        record_date, 
        EXTRACT(DAY FROM record_date) AS day,
        CASE 
            WHEN EXTRACT(DAY FROM record_date) BETWEEN 1 AND 7 THEN 'week1'
            WHEN EXTRACT(DAY FROM record_date) BETWEEN 8 AND 14 THEN 'week2'
            WHEN EXTRACT(DAY FROM record_date) BETWEEN 15 AND 21 THEN 'week3'
            ELSE 'week4'
        END AS week
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    week, 
    SUM(amount) AS total_amount 
FROM fin_cte3 
GROUP BY week order by week asc': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 14:     FROM finance_insights_wrk.ocotber_2024
                  ^

2024-10-26 01:22:31,607 - INFO - No data returned for query 6.
2024-10-26 01:22:31,610 - INFO - Error executing SQL query: -- 7. Unexpected/Overbudget Expenses
SELECT 
    expense_category,
    expected_budget,
    amount,
    (amount - expected_budget)::NUMERIC AS extra,
    CASE 
        WHEN expected_budget ::NUMERIC<> 0 THEN ROUND(((amount - expected_budget)::NUMERIC / NULLIF(expected_budget, 0)::NUMERIC)::NUMERIC * 100::NUMERIC, 2)::NUMERIC 
        ELSE NULL 
    END AS extra_percent
FROM finance_insights_wrk.ocotber_2024 
WHERE amount::NUMERIC > expected_budget::NUMERIC
Execution failed on sql '-- 7. Unexpected/Overbudget Expenses
SELECT 
    expense_category,
    expected_budget,
    amount,
    (amount - expected_budget)::NUMERIC AS extra,
    CASE 
        WHEN expected_budget ::NUMERIC<> 0 THEN ROUND(((amount - expected_budget)::NUMERIC / NULLIF(expected_budget, 0)::NUMERIC)::NUMERIC * 100::NUMERIC, 2)::NUMERIC 
        ELSE NULL 
    END AS extra_percent
FROM finance_insights_wrk.ocotber_2024 
WHERE amount::NUMERIC > expected_budget::NUMERIC': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 11: FROM finance_insights_wrk.ocotber_2024 
              ^

2024-10-26 01:22:31,610 - INFO - No data returned for query 7.
2024-10-26 01:22:31,613 - INFO - Error executing SQL query: -- 8. Daily Spending Variance from Budget
WITH fin_cte4 AS (
    SELECT 
        expense_category,
        expected_budget,
        amount,
        record_date,
        (expected_budget - amount) AS deviation 
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    * 
FROM fin_cte4
Execution failed on sql '-- 8. Daily Spending Variance from Budget
WITH fin_cte4 AS (
    SELECT 
        expense_category,
        expected_budget,
        amount,
        record_date,
        (expected_budget - amount) AS deviation 
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    * 
FROM fin_cte4': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 9:     FROM finance_insights_wrk.ocotber_2024
                 ^

2024-10-26 01:22:31,614 - INFO - No data returned for query 8.
2024-10-26 01:22:31,618 - INFO - Error executing SQL query: -- 9. Opportunity Cost Analysis
WITH fin_cte5 AS (
    SELECT 
        *,
        (amount - expected_budget) AS deviation 
    FROM finance_insights_wrk.ocotber_2024 
    WHERE financial_category = 'wants' AND amount <> 0
)
SELECT 
    SUM(deviation) AS opportunity_cost,
    'This amount could have been invested' AS investment_opportunity 
FROM fin_cte5
Execution failed on sql '-- 9. Opportunity Cost Analysis
WITH fin_cte5 AS (
    SELECT 
        *,
        (amount - expected_budget) AS deviation 
    FROM finance_insights_wrk.ocotber_2024 
    WHERE financial_category = 'wants' AND amount <> 0
)
SELECT 
    SUM(deviation) AS opportunity_cost,
    'This amount could have been invested' AS investment_opportunity 
FROM fin_cte5': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 6:     FROM finance_insights_wrk.ocotber_2024 
                 ^

2024-10-26 01:22:31,619 - INFO - No data returned for query 9.
2024-10-26 01:22:31,621 - INFO - Error executing SQL query: -- 10. Psychological Spending Analysis
SELECT 
    *, 
    (amount - expected_budget) AS deviation 
FROM finance_insights_wrk.ocotber_2024 
WHERE financial_category = 'wants' AND amount <> 0
Execution failed on sql '-- 10. Psychological Spending Analysis
SELECT 
    *, 
    (amount - expected_budget) AS deviation 
FROM finance_insights_wrk.ocotber_2024 
WHERE financial_category = 'wants' AND amount <> 0': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 5: FROM finance_insights_wrk.ocotber_2024 
             ^

2024-10-26 01:22:31,621 - INFO - No data returned for query 10.
2024-10-26 01:22:31,627 - INFO - Error executing SQL query: -- 11. Needs, Wants, and Investment Distribution
SELECT 
    amount_data.financial_category,
    budget_data.total_budget,
    amount_data.total_amount,
    budget_data.budget_percent,
    amount_data.amount_percent 
FROM 
    (SELECT 
        financial_category,
        SUM(expected_budget::NUMERIC) AS total_budget,
        ROUND(
            (SUM(expected_budget::NUMERIC) / NULLIF((SELECT SUM(expected_budget::NUMERIC) FROM finance_insights_wrk.ocotber_2024), 0)) * 100,
            2
        ) AS budget_percent 
    FROM finance_insights_wrk.ocotber_2024 
    GROUP BY financial_category) AS budget_data
FULL OUTER JOIN 
    (SELECT 
        financial_category,
        SUM(amount::NUMERIC) AS total_amount,
        ROUND(
            (SUM(amount::NUMERIC) / NULLIF((SELECT SUM(amount::NUMERIC) FROM finance_insights_int.ocotber_2024), 0)) * 100,
            2
        ) AS amount_percent  
    FROM finance_insights_wrk.ocotber_2024 
    GROUP BY financial_category) AS amount_data 
ON budget_data.financial_category = amount_data.financial_category
Execution failed on sql '-- 11. Needs, Wants, and Investment Distribution
SELECT 
    amount_data.financial_category,
    budget_data.total_budget,
    amount_data.total_amount,
    budget_data.budget_percent,
    amount_data.amount_percent 
FROM 
    (SELECT 
        financial_category,
        SUM(expected_budget::NUMERIC) AS total_budget,
        ROUND(
            (SUM(expected_budget::NUMERIC) / NULLIF((SELECT SUM(expected_budget::NUMERIC) FROM finance_insights_wrk.ocotber_2024), 0)) * 100,
            2
        ) AS budget_percent 
    FROM finance_insights_wrk.ocotber_2024 
    GROUP BY financial_category) AS budget_data
FULL OUTER JOIN 
    (SELECT 
        financial_category,
        SUM(amount::NUMERIC) AS total_amount,
        ROUND(
            (SUM(amount::NUMERIC) / NULLIF((SELECT SUM(amount::NUMERIC) FROM finance_insights_int.ocotber_2024), 0)) * 100,
            2
        ) AS amount_percent  
    FROM finance_insights_wrk.ocotber_2024 
    GROUP BY financial_category) AS amount_data 
ON budget_data.financial_category = amount_data.financial_category': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 16:     FROM finance_insights_wrk.ocotber_2024 
                  ^

2024-10-26 01:22:31,627 - INFO - No data returned for query 11.
2024-10-26 01:22:31,631 - INFO - Error executing SQL query: -- 12. Pending Payment Mode Status
SELECT 
    *, 
    SUM(expected_budget::NUMERIC) OVER (ORDER BY record_date, amount) AS cum_budget_transferred 
FROM finance_insights_int.ocotber_2024 
WHERE payment_status IN ('pending')
Execution failed on sql '-- 12. Pending Payment Mode Status
SELECT 
    *, 
    SUM(expected_budget::NUMERIC) OVER (ORDER BY record_date, amount) AS cum_budget_transferred 
FROM finance_insights_int.ocotber_2024 
WHERE payment_status IN ('pending')': relation "finance_insights_int.ocotber_2024" does not exist
LINE 5: FROM finance_insights_int.ocotber_2024 
             ^

2024-10-26 01:22:31,631 - INFO - No data returned for query 12.
2024-10-26 01:22:31,634 - INFO - Error executing SQL query: -- 13. 1st 15 Days vs Last 15 Days Expenses
WITH cte5 AS (
    SELECT 
        EXTRACT(DAY FROM record_date) AS day_of_month,
        *,
        CASE 
            WHEN EXTRACT(DAY FROM record_date) <= 15 THEN '1st 15 days' 
            ELSE 'Last 15 days' 
        END AS day_period
    FROM finance_insights_wrk.ocotber_2024
),
cte6 AS (
    SELECT 
        day_period,
        SUM(amount) AS total_amount 
    FROM cte5 
    GROUP BY day_period
)
SELECT 
    day_period,
    total_amount,
    ROUND((total_amount::NUMERIC / NULLIF(SUM(total_amount::NUMERIC) OVER (), 0)::NUMERIC) * 100, 2) AS percentage 
FROM cte6
Execution failed on sql '-- 13. 1st 15 Days vs Last 15 Days Expenses
WITH cte5 AS (
    SELECT 
        EXTRACT(DAY FROM record_date) AS day_of_month,
        *,
        CASE 
            WHEN EXTRACT(DAY FROM record_date) <= 15 THEN '1st 15 days' 
            ELSE 'Last 15 days' 
        END AS day_period
    FROM finance_insights_wrk.ocotber_2024
),
cte6 AS (
    SELECT 
        day_period,
        SUM(amount) AS total_amount 
    FROM cte5 
    GROUP BY day_period
)
SELECT 
    day_period,
    total_amount,
    ROUND((total_amount::NUMERIC / NULLIF(SUM(total_amount::NUMERIC) OVER (), 0)::NUMERIC) * 100, 2) AS percentage 
FROM cte6': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 10:     FROM finance_insights_wrk.ocotber_2024
                  ^

2024-10-26 01:22:31,635 - INFO - No data returned for query 13.
2024-10-26 01:22:31,640 - INFO - Error executing SQL query: -- 14. Maximum Expense Category and its Percentage
WITH cte8 AS (
    SELECT 
        expense_category,
        SUM(amount) AS total_amount 
    FROM finance_insights_wrk.ocotber_2024 
    WHERE financial_category <> 'invest' 
    GROUP BY expense_category 
    ORDER BY total_amount DESC
)
SELECT 
    *, 
    ROUND((total_amount::NUMERIC / NULLIF(SUM(total_amount::NUMERIC) OVER (), 0)::NUMERIC) * 100, 2) AS Percentage_expense 
FROM cte8 
ORDER BY total_amount DESC 
LIMIT 1
Execution failed on sql '-- 14. Maximum Expense Category and its Percentage
WITH cte8 AS (
    SELECT 
        expense_category,
        SUM(amount) AS total_amount 
    FROM finance_insights_wrk.ocotber_2024 
    WHERE financial_category <> 'invest' 
    GROUP BY expense_category 
    ORDER BY total_amount DESC
)
SELECT 
    *, 
    ROUND((total_amount::NUMERIC / NULLIF(SUM(total_amount::NUMERIC) OVER (), 0)::NUMERIC) * 100, 2) AS Percentage_expense 
FROM cte8 
ORDER BY total_amount DESC 
LIMIT 1': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 6:     FROM finance_insights_wrk.ocotber_2024 
                 ^

2024-10-26 01:22:31,640 - INFO - No data returned for query 14.
2024-10-26 01:22:31,644 - INFO - Error executing SQL query: -- 15. Top N Expense Categories
WITH cte9 AS (
    SELECT 
        expense_category,
        SUM(amount) AS total_amount 
    FROM finance_insights_wrk.ocotber_2024 
    WHERE financial_category <> 'invest' 
    GROUP BY expense_category
)
SELECT 
    *, 
    ROUND((total_amount::NUMERIC / NULLIF(SUM(total_amount::NUMERIC) OVER (), 0)::NUMERIC) * 100, 2) AS Percentage_expense 
FROM cte9 
ORDER BY total_amount DESC 
LIMIT 7
Execution failed on sql '-- 15. Top N Expense Categories
WITH cte9 AS (
    SELECT 
        expense_category,
        SUM(amount) AS total_amount 
    FROM finance_insights_wrk.ocotber_2024 
    WHERE financial_category <> 'invest' 
    GROUP BY expense_category
)
SELECT 
    *, 
    ROUND((total_amount::NUMERIC / NULLIF(SUM(total_amount::NUMERIC) OVER (), 0)::NUMERIC) * 100, 2) AS Percentage_expense 
FROM cte9 
ORDER BY total_amount DESC 
LIMIT 7': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 6:     FROM finance_insights_wrk.ocotber_2024 
                 ^

2024-10-26 01:22:31,644 - INFO - No data returned for query 15.
2024-10-26 01:22:31,648 - INFO - Error executing SQL query: -- 16. Weekdays vs Weekends Spending
WITH cte_10 AS (
    SELECT 
        EXTRACT(DAY FROM record_date) AS day_,
        TO_CHAR(record_date, 'FMDay') AS day_name,
        *,
        CASE 
            WHEN TO_CHAR(record_date, 'FMDay') NOT IN ('Saturday', 'Sunday') THEN 'weekdays' 
            ELSE 'weekend' 
        END AS day_type
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    day_type,
    SUM(amount) AS total_amount,
    ROUND(SUM(amount)::NUMERIC * 100.0 / NULLIF(SUM(SUM(amount)) OVER (), 0)::NUMERIC, 2) AS percentage 
FROM cte_10 
GROUP BY day_type
Execution failed on sql '-- 16. Weekdays vs Weekends Spending
WITH cte_10 AS (
    SELECT 
        EXTRACT(DAY FROM record_date) AS day_,
        TO_CHAR(record_date, 'FMDay') AS day_name,
        *,
        CASE 
            WHEN TO_CHAR(record_date, 'FMDay') NOT IN ('Saturday', 'Sunday') THEN 'weekdays' 
            ELSE 'weekend' 
        END AS day_type
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    day_type,
    SUM(amount) AS total_amount,
    ROUND(SUM(amount)::NUMERIC * 100.0 / NULLIF(SUM(SUM(amount)) OVER (), 0)::NUMERIC, 2) AS percentage 
FROM cte_10 
GROUP BY day_type': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 11:     FROM finance_insights_wrk.ocotber_2024
                  ^

2024-10-26 01:22:31,648 - INFO - No data returned for query 16.
2024-10-26 01:22:31,652 - INFO - Error executing SQL query: -- 17. Category-wise Distribution by Day Type
WITH cte_11 AS (
    SELECT 
        EXTRACT(DAY FROM record_date) AS day_,
        TO_CHAR(record_date, 'FMDay') AS day_name,
        *,
        CASE 
            WHEN TO_CHAR(record_date, 'FMDay') NOT IN ('Saturday', 'Sunday') THEN 'weekdays' 
            ELSE 'weekend' 
        END AS day_type
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    day_,
    day_name,
    expense_category,
    financial_category,
    transaction_type,
    amount,
    day_type,
    SUM(amount) OVER (PARTITION BY day_type ORDER BY day_) 
FROM cte_11
Execution failed on sql '-- 17. Category-wise Distribution by Day Type
WITH cte_11 AS (
    SELECT 
        EXTRACT(DAY FROM record_date) AS day_,
        TO_CHAR(record_date, 'FMDay') AS day_name,
        *,
        CASE 
            WHEN TO_CHAR(record_date, 'FMDay') NOT IN ('Saturday', 'Sunday') THEN 'weekdays' 
            ELSE 'weekend' 
        END AS day_type
    FROM finance_insights_wrk.ocotber_2024
)
SELECT 
    day_,
    day_name,
    expense_category,
    financial_category,
    transaction_type,
    amount,
    day_type,
    SUM(amount) OVER (PARTITION BY day_type ORDER BY day_) 
FROM cte_11': relation "finance_insights_wrk.ocotber_2024" does not exist
LINE 11:     FROM finance_insights_wrk.ocotber_2024
                  ^

2024-10-26 01:22:31,653 - INFO - No data returned for query 17.
2024-10-26 01:22:31,655 - INFO - Error executing SQL query: -- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.
Execution failed on sql '-- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.': can't execute an empty query
2024-10-26 01:22:31,656 - INFO - No data returned for query 18.
2024-10-26 01:23:51,670 - INFO - ###############
2024-10-26 01:23:51,671 - INFO - SQL TO EXCEL in Progress
2024-10-26 01:23:51,753 - INFO - DB Connected for SQL to Excel conversion.
2024-10-26 01:23:51,801 - INFO - Query 1 data written to Savings Rate.
2024-10-26 01:23:51,820 - INFO - Query 2 data written to Recurring vs Non-Recurring.
2024-10-26 01:23:51,860 - INFO - Query 3 data written to Expense Efficiency.
2024-10-26 01:23:51,871 - INFO - Query 4 data written to Highest Daily Expense.
2024-10-26 01:23:51,877 - INFO - Query 5 data written to Lowest Daily Expense.
2024-10-26 01:23:51,882 - INFO - Query 6 data written to Weekly Expense Analysis.
2024-10-26 01:23:51,886 - INFO - Query 7 data written to Unexpected Expenses.
2024-10-26 01:23:51,895 - INFO - Query 8 data written to Daily Spending Variance.
2024-10-26 01:23:51,909 - INFO - Query 9 data written to Opportunity Cost Analysis.
2024-10-26 01:23:51,915 - INFO - Query 10 data written to Psychological Spending.
2024-10-26 01:23:51,932 - INFO - Query 11 data written to Needs Wants Investments.
2024-10-26 01:23:51,943 - INFO - Query 12 data written to Pending Payments.
2024-10-26 01:23:51,949 - INFO - Query 13 data written to 1st 15 Days vs Last 15 Days.
2024-10-26 01:23:51,953 - INFO - Query 14 data written to Max Expense Category.
2024-10-26 01:23:51,957 - INFO - Query 15 data written to Top N Expense Categories.
2024-10-26 01:23:51,966 - INFO - Query 16 data written to Weekdays vs Weekends.
2024-10-26 01:23:51,974 - INFO - Query 17 data written to Category-wise.
2024-10-26 01:23:51,994 - INFO - Error executing SQL query: -- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.
Execution failed on sql '-- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.': can't execute an empty query
2024-10-26 01:23:51,998 - INFO - No data returned for query 18.
2024-10-26 01:23:52,248 - INFO - Database connection closed.
2024-10-26 01:23:52,248 - INFO - Data export completed. Check the file: REPORTS/October_2024_REPORT.xlsx
2024-10-26 01:24:43,926 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:24:43,926 - INFO - ###############
2024-10-26 01:24:43,926 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:24:43,926 - INFO - Data Integration from finance_insights_stg to finance_insights_int is in progress
2024-10-26 01:24:43,991 - INFO - ###########all tables
2024-10-26 01:24:44,010 - INFO - ######Batch loading from finance_insights_stg to finance_insights_int in Progress !!
2024-10-26 01:24:44,010 - INFO - Fetching all the tables from current schema  : finance_insights_stg 
2024-10-26 01:24:44,010 - INFO - [('november_2024',), ('april_2024',), ('may_2024',), ('june_2024',), ('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',)]
2024-10-26 01:24:44,010 - INFO - #############################
2024-10-26 01:24:44,011 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,013 - INFO - Table finance_insights_int.november_2024 already exists !! 
2024-10-26 01:24:44,013 - INFO - Dropping off the table
2024-10-26 01:24:44,033 - INFO - Creating ddl for finance_insights_int.november_2024
2024-10-26 01:24:44,054 - INFO - #############################
2024-10-26 01:24:44,056 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,056 - INFO - Table finance_insights_int.april_2024 already exists !! 
2024-10-26 01:24:44,057 - INFO - Dropping off the table
2024-10-26 01:24:44,057 - INFO - Creating ddl for finance_insights_int.april_2024
2024-10-26 01:24:44,067 - INFO - Target table : finance_insights_int.april_2024 created successfully !!
2024-10-26 01:24:44,068 - INFO - Data copied from finance_insights_stg.april_2024 to finance_insights_int.april_2024 successful!!!
2024-10-26 01:24:44,068 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,068 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,076 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,082 - INFO - Changes made successfully!!
2024-10-26 01:24:44,082 - INFO - #############################
2024-10-26 01:24:44,083 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,084 - INFO - Table finance_insights_int.may_2024 already exists !! 
2024-10-26 01:24:44,084 - INFO - Dropping off the table
2024-10-26 01:24:44,085 - INFO - Creating ddl for finance_insights_int.may_2024
2024-10-26 01:24:44,095 - INFO - Target table : finance_insights_int.may_2024 created successfully !!
2024-10-26 01:24:44,097 - INFO - Data copied from finance_insights_stg.may_2024 to finance_insights_int.may_2024 successful!!!
2024-10-26 01:24:44,097 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,097 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,104 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,108 - INFO - Changes made successfully!!
2024-10-26 01:24:44,108 - INFO - #############################
2024-10-26 01:24:44,110 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,111 - INFO - Table finance_insights_int.june_2024 already exists !! 
2024-10-26 01:24:44,111 - INFO - Dropping off the table
2024-10-26 01:24:44,112 - INFO - Creating ddl for finance_insights_int.june_2024
2024-10-26 01:24:44,120 - INFO - Target table : finance_insights_int.june_2024 created successfully !!
2024-10-26 01:24:44,121 - INFO - Data copied from finance_insights_stg.june_2024 to finance_insights_int.june_2024 successful!!!
2024-10-26 01:24:44,123 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,123 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,129 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,133 - INFO - Changes made successfully!!
2024-10-26 01:24:44,133 - INFO - #############################
2024-10-26 01:24:44,134 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,135 - INFO - Table finance_insights_int.july_2024 already exists !! 
2024-10-26 01:24:44,135 - INFO - Dropping off the table
2024-10-26 01:24:44,136 - INFO - Creating ddl for finance_insights_int.july_2024
2024-10-26 01:24:44,147 - INFO - Target table : finance_insights_int.july_2024 created successfully !!
2024-10-26 01:24:44,148 - INFO - Data copied from finance_insights_stg.july_2024 to finance_insights_int.july_2024 successful!!!
2024-10-26 01:24:44,148 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,148 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,155 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,159 - INFO - Changes made successfully!!
2024-10-26 01:24:44,159 - INFO - #############################
2024-10-26 01:24:44,161 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,163 - INFO - Table finance_insights_int.august_2024 already exists !! 
2024-10-26 01:24:44,163 - INFO - Dropping off the table
2024-10-26 01:24:44,163 - INFO - Creating ddl for finance_insights_int.august_2024
2024-10-26 01:24:44,171 - INFO - Target table : finance_insights_int.august_2024 created successfully !!
2024-10-26 01:24:44,172 - INFO - Data copied from finance_insights_stg.august_2024 to finance_insights_int.august_2024 successful!!!
2024-10-26 01:24:44,173 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,173 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,179 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,183 - INFO - Changes made successfully!!
2024-10-26 01:24:44,184 - INFO - #############################
2024-10-26 01:24:44,185 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,186 - INFO - Table finance_insights_int.september_2024 already exists !! 
2024-10-26 01:24:44,186 - INFO - Dropping off the table
2024-10-26 01:24:44,186 - INFO - Creating ddl for finance_insights_int.september_2024
2024-10-26 01:24:44,196 - INFO - Target table : finance_insights_int.september_2024 created successfully !!
2024-10-26 01:24:44,197 - INFO - Data copied from finance_insights_stg.september_2024 to finance_insights_int.september_2024 successful!!!
2024-10-26 01:24:44,198 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,198 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,205 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,209 - INFO - Changes made successfully!!
2024-10-26 01:24:44,211 - INFO - #############################
2024-10-26 01:24:44,212 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:44,212 - INFO - Table finance_insights_int.october_2024 already exists !! 
2024-10-26 01:24:44,212 - INFO - Dropping off the table
2024-10-26 01:24:44,213 - INFO - Creating ddl for finance_insights_int.october_2024
2024-10-26 01:24:44,222 - INFO - Target table : finance_insights_int.october_2024 created successfully !!
2024-10-26 01:24:44,223 - INFO - Data copied from finance_insights_stg.october_2024 to finance_insights_int.october_2024 successful!!!
2024-10-26 01:24:44,223 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:44,223 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:44,229 - INFO - file_nm insertion successfull
2024-10-26 01:24:44,234 - INFO - Changes made successfully!!
2024-10-26 01:24:58,091 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:24:58,091 - INFO - ###############
2024-10-26 01:24:58,091 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:24:58,091 - INFO - Data Integration from finance_insights_int to finance_insights_wrk is in progress
2024-10-26 01:24:58,159 - INFO - ###########all tables
2024-10-26 01:24:58,169 - INFO - ######Batch loading from finance_insights_int to finance_insights_wrk in Progress !!
2024-10-26 01:24:58,169 - INFO - Fetching all the tables from current schema  : finance_insights_int 
2024-10-26 01:24:58,169 - INFO - [('april_2024',), ('may_2024',), ('june_2024',), ('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',), ('november_2024',)]
2024-10-26 01:24:58,169 - INFO - Storing the views in a temp layer 
2024-10-26 01:24:58,214 - INFO - Droping the views for proper data load to wrk 
2024-10-26 01:24:58,218 - INFO - #############################
2024-10-26 01:24:58,219 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,220 - INFO - Table finance_insights_wrk.april_2024 already exists !! 
2024-10-26 01:24:58,220 - INFO - Dropping off the table
2024-10-26 01:24:58,221 - INFO - Creating ddl for finance_insights_wrk.april_2024
2024-10-26 01:24:58,232 - INFO - Target table : finance_insights_wrk.april_2024 created successfully !!
2024-10-26 01:24:58,234 - INFO - Data copied from finance_insights_int.april_2024 to finance_insights_wrk.april_2024 successful!!!
2024-10-26 01:24:58,234 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,234 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,240 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,244 - INFO - Changes made successfully!!
2024-10-26 01:24:58,244 - INFO - #############################
2024-10-26 01:24:58,245 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,246 - INFO - Table finance_insights_wrk.may_2024 already exists !! 
2024-10-26 01:24:58,246 - INFO - Dropping off the table
2024-10-26 01:24:58,247 - INFO - Creating ddl for finance_insights_wrk.may_2024
2024-10-26 01:24:58,257 - INFO - Target table : finance_insights_wrk.may_2024 created successfully !!
2024-10-26 01:24:58,258 - INFO - Data copied from finance_insights_int.may_2024 to finance_insights_wrk.may_2024 successful!!!
2024-10-26 01:24:58,258 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,258 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,264 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,268 - INFO - Changes made successfully!!
2024-10-26 01:24:58,268 - INFO - #############################
2024-10-26 01:24:58,271 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,271 - INFO - Table finance_insights_wrk.june_2024 already exists !! 
2024-10-26 01:24:58,272 - INFO - Dropping off the table
2024-10-26 01:24:58,272 - INFO - Creating ddl for finance_insights_wrk.june_2024
2024-10-26 01:24:58,280 - INFO - Target table : finance_insights_wrk.june_2024 created successfully !!
2024-10-26 01:24:58,282 - INFO - Data copied from finance_insights_int.june_2024 to finance_insights_wrk.june_2024 successful!!!
2024-10-26 01:24:58,282 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,282 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,288 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,293 - INFO - Changes made successfully!!
2024-10-26 01:24:58,293 - INFO - #############################
2024-10-26 01:24:58,294 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,294 - INFO - Table finance_insights_wrk.july_2024 already exists !! 
2024-10-26 01:24:58,294 - INFO - Dropping off the table
2024-10-26 01:24:58,295 - INFO - Creating ddl for finance_insights_wrk.july_2024
2024-10-26 01:24:58,304 - INFO - Target table : finance_insights_wrk.july_2024 created successfully !!
2024-10-26 01:24:58,305 - INFO - Data copied from finance_insights_int.july_2024 to finance_insights_wrk.july_2024 successful!!!
2024-10-26 01:24:58,305 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,305 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,312 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,316 - INFO - Changes made successfully!!
2024-10-26 01:24:58,316 - INFO - #############################
2024-10-26 01:24:58,318 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,319 - INFO - Table finance_insights_wrk.august_2024 already exists !! 
2024-10-26 01:24:58,319 - INFO - Dropping off the table
2024-10-26 01:24:58,320 - INFO - Creating ddl for finance_insights_wrk.august_2024
2024-10-26 01:24:58,329 - INFO - Target table : finance_insights_wrk.august_2024 created successfully !!
2024-10-26 01:24:58,331 - INFO - Data copied from finance_insights_int.august_2024 to finance_insights_wrk.august_2024 successful!!!
2024-10-26 01:24:58,331 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,331 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,339 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,343 - INFO - Changes made successfully!!
2024-10-26 01:24:58,343 - INFO - #############################
2024-10-26 01:24:58,344 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,346 - INFO - Table finance_insights_wrk.september_2024 already exists !! 
2024-10-26 01:24:58,346 - INFO - Dropping off the table
2024-10-26 01:24:58,347 - INFO - Creating ddl for finance_insights_wrk.september_2024
2024-10-26 01:24:58,356 - INFO - Target table : finance_insights_wrk.september_2024 created successfully !!
2024-10-26 01:24:58,357 - INFO - Data copied from finance_insights_int.september_2024 to finance_insights_wrk.september_2024 successful!!!
2024-10-26 01:24:58,357 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,358 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,365 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,369 - INFO - Changes made successfully!!
2024-10-26 01:24:58,369 - INFO - #############################
2024-10-26 01:24:58,371 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,372 - INFO - Table finance_insights_wrk.october_2024 already exists !! 
2024-10-26 01:24:58,372 - INFO - Dropping off the table
2024-10-26 01:24:58,372 - INFO - Creating ddl for finance_insights_wrk.october_2024
2024-10-26 01:24:58,383 - INFO - Target table : finance_insights_wrk.october_2024 created successfully !!
2024-10-26 01:24:58,384 - INFO - Data copied from finance_insights_int.october_2024 to finance_insights_wrk.october_2024 successful!!!
2024-10-26 01:24:58,384 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,384 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,391 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,395 - INFO - Changes made successfully!!
2024-10-26 01:24:58,395 - INFO - #############################
2024-10-26 01:24:58,396 - INFO - Checking if the target table already exists : 
2024-10-26 01:24:58,398 - INFO - Table finance_insights_wrk.november_2024 already exists !! 
2024-10-26 01:24:58,398 - INFO - Dropping off the table
2024-10-26 01:24:58,399 - INFO - Creating ddl for finance_insights_wrk.november_2024
2024-10-26 01:24:58,408 - INFO - Target table : finance_insights_wrk.november_2024 created successfully !!
2024-10-26 01:24:58,410 - INFO - Data copied from finance_insights_int.november_2024 to finance_insights_wrk.november_2024 successful!!!
2024-10-26 01:24:58,410 - INFO - Temp table for file_nm insertion
2024-10-26 01:24:58,410 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:24:58,419 - INFO - file_nm insertion successfull
2024-10-26 01:24:58,424 - INFO - Changes made successfully!!
2024-10-26 01:24:58,424 - INFO - Recreating all the views !!
2024-10-26 01:25:07,569 - INFO - ###############
2024-10-26 01:25:07,569 - INFO - SQL TO EXCEL in Progress
2024-10-26 01:25:07,639 - INFO - DB Connected for SQL to Excel conversion.
2024-10-26 01:25:07,658 - INFO - Query 1 data written to Savings Rate.
2024-10-26 01:25:07,668 - INFO - Query 2 data written to Recurring vs Non-Recurring.
2024-10-26 01:25:07,705 - INFO - Query 3 data written to Expense Efficiency.
2024-10-26 01:25:07,711 - INFO - Query 4 data written to Highest Daily Expense.
2024-10-26 01:25:07,715 - INFO - Query 5 data written to Lowest Daily Expense.
2024-10-26 01:25:07,721 - INFO - Query 6 data written to Weekly Expense Analysis.
2024-10-26 01:25:07,726 - INFO - Query 7 data written to Unexpected Expenses.
2024-10-26 01:25:07,739 - INFO - Query 8 data written to Daily Spending Variance.
2024-10-26 01:25:07,754 - INFO - Query 9 data written to Opportunity Cost Analysis.
2024-10-26 01:25:07,760 - INFO - Query 10 data written to Psychological Spending.
2024-10-26 01:25:07,773 - INFO - Query 11 data written to Needs Wants Investments.
2024-10-26 01:25:07,781 - INFO - No data returned for query 12.
2024-10-26 01:25:07,785 - INFO - Query 13 data written to 1st 15 Days vs Last 15 Days.
2024-10-26 01:25:07,789 - INFO - Query 14 data written to Max Expense Category.
2024-10-26 01:25:07,793 - INFO - Query 15 data written to Top N Expense Categories.
2024-10-26 01:25:07,802 - INFO - Query 16 data written to Weekdays vs Weekends.
2024-10-26 01:25:07,814 - INFO - Query 17 data written to Category-wise.
2024-10-26 01:25:07,854 - INFO - Error executing SQL query: -- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.
Execution failed on sql '-- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.': can't execute an empty query
2024-10-26 01:25:07,855 - INFO - No data returned for query 18.
2024-10-26 01:25:08,139 - INFO - Database connection closed.
2024-10-26 01:25:08,139 - INFO - Data export completed. Check the file: REPORTS/September_2024_REPORT.xlsx
2024-10-26 01:25:37,757 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:25:37,757 - INFO - ###############
2024-10-26 01:25:37,757 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:25:37,757 - INFO - Data Integration from finance_insights_stg to finance_insights_int is in progress
2024-10-26 01:25:37,829 - INFO - ###########all tables
2024-10-26 01:25:37,841 - INFO - ######Batch loading from finance_insights_stg to finance_insights_int in Progress !!
2024-10-26 01:25:37,841 - INFO - Fetching all the tables from current schema  : finance_insights_stg 
2024-10-26 01:25:37,841 - INFO - [('november_2024',), ('april_2024',), ('may_2024',), ('june_2024',), ('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',)]
2024-10-26 01:25:37,841 - INFO - #############################
2024-10-26 01:25:37,843 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:37,844 - INFO - Table finance_insights_int.november_2024 already exists !! 
2024-10-26 01:25:37,844 - INFO - Dropping off the table
2024-10-26 01:25:37,845 - INFO - Creating ddl for finance_insights_int.november_2024
2024-10-26 01:25:37,863 - INFO - #############################
2024-10-26 01:25:37,864 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:37,865 - INFO - Table finance_insights_int.april_2024 already exists !! 
2024-10-26 01:25:37,865 - INFO - Dropping off the table
2024-10-26 01:25:37,865 - INFO - Creating ddl for finance_insights_int.april_2024
2024-10-26 01:25:37,874 - INFO - Target table : finance_insights_int.april_2024 created successfully !!
2024-10-26 01:25:37,875 - INFO - Data copied from finance_insights_stg.april_2024 to finance_insights_int.april_2024 successful!!!
2024-10-26 01:25:37,875 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:37,875 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:37,880 - INFO - file_nm insertion successfull
2024-10-26 01:25:37,887 - INFO - Changes made successfully!!
2024-10-26 01:25:37,887 - INFO - #############################
2024-10-26 01:25:37,888 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:37,889 - INFO - Table finance_insights_int.may_2024 already exists !! 
2024-10-26 01:25:37,889 - INFO - Dropping off the table
2024-10-26 01:25:37,890 - INFO - Creating ddl for finance_insights_int.may_2024
2024-10-26 01:25:37,901 - INFO - Target table : finance_insights_int.may_2024 created successfully !!
2024-10-26 01:25:37,903 - INFO - Data copied from finance_insights_stg.may_2024 to finance_insights_int.may_2024 successful!!!
2024-10-26 01:25:37,904 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:37,904 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:37,912 - INFO - file_nm insertion successfull
2024-10-26 01:25:37,919 - INFO - Changes made successfully!!
2024-10-26 01:25:37,920 - INFO - #############################
2024-10-26 01:25:37,921 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:37,923 - INFO - Table finance_insights_int.june_2024 already exists !! 
2024-10-26 01:25:37,923 - INFO - Dropping off the table
2024-10-26 01:25:37,923 - INFO - Creating ddl for finance_insights_int.june_2024
2024-10-26 01:25:37,934 - INFO - Target table : finance_insights_int.june_2024 created successfully !!
2024-10-26 01:25:37,936 - INFO - Data copied from finance_insights_stg.june_2024 to finance_insights_int.june_2024 successful!!!
2024-10-26 01:25:37,936 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:37,936 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:37,945 - INFO - file_nm insertion successfull
2024-10-26 01:25:37,950 - INFO - Changes made successfully!!
2024-10-26 01:25:37,950 - INFO - #############################
2024-10-26 01:25:37,952 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:37,953 - INFO - Table finance_insights_int.july_2024 already exists !! 
2024-10-26 01:25:37,953 - INFO - Dropping off the table
2024-10-26 01:25:37,954 - INFO - Creating ddl for finance_insights_int.july_2024
2024-10-26 01:25:37,964 - INFO - Target table : finance_insights_int.july_2024 created successfully !!
2024-10-26 01:25:37,966 - INFO - Data copied from finance_insights_stg.july_2024 to finance_insights_int.july_2024 successful!!!
2024-10-26 01:25:37,966 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:37,966 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:37,974 - INFO - file_nm insertion successfull
2024-10-26 01:25:37,979 - INFO - Changes made successfully!!
2024-10-26 01:25:37,979 - INFO - #############################
2024-10-26 01:25:37,980 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:37,981 - INFO - Table finance_insights_int.august_2024 already exists !! 
2024-10-26 01:25:37,981 - INFO - Dropping off the table
2024-10-26 01:25:37,982 - INFO - Creating ddl for finance_insights_int.august_2024
2024-10-26 01:25:37,992 - INFO - Target table : finance_insights_int.august_2024 created successfully !!
2024-10-26 01:25:37,993 - INFO - Data copied from finance_insights_stg.august_2024 to finance_insights_int.august_2024 successful!!!
2024-10-26 01:25:37,993 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:37,993 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:37,999 - INFO - file_nm insertion successfull
2024-10-26 01:25:38,005 - INFO - Changes made successfully!!
2024-10-26 01:25:38,005 - INFO - #############################
2024-10-26 01:25:38,006 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:38,007 - INFO - Table finance_insights_int.september_2024 already exists !! 
2024-10-26 01:25:38,007 - INFO - Dropping off the table
2024-10-26 01:25:38,008 - INFO - Creating ddl for finance_insights_int.september_2024
2024-10-26 01:25:38,017 - INFO - Target table : finance_insights_int.september_2024 created successfully !!
2024-10-26 01:25:38,020 - INFO - Data copied from finance_insights_stg.september_2024 to finance_insights_int.september_2024 successful!!!
2024-10-26 01:25:38,020 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:38,020 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:38,027 - INFO - file_nm insertion successfull
2024-10-26 01:25:38,032 - INFO - Changes made successfully!!
2024-10-26 01:25:38,032 - INFO - #############################
2024-10-26 01:25:38,033 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:38,034 - INFO - Table finance_insights_int.october_2024 already exists !! 
2024-10-26 01:25:38,034 - INFO - Dropping off the table
2024-10-26 01:25:38,035 - INFO - Creating ddl for finance_insights_int.october_2024
2024-10-26 01:25:38,042 - INFO - Target table : finance_insights_int.october_2024 created successfully !!
2024-10-26 01:25:38,043 - INFO - Data copied from finance_insights_stg.october_2024 to finance_insights_int.october_2024 successful!!!
2024-10-26 01:25:38,043 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:38,044 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:38,049 - INFO - file_nm insertion successfull
2024-10-26 01:25:38,054 - INFO - Changes made successfully!!
2024-10-26 01:25:49,154 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:25:49,154 - INFO - ###############
2024-10-26 01:25:49,155 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:25:49,155 - INFO - Data Integration from finance_insights_int to finance_insights_wrk is in progress
2024-10-26 01:25:49,223 - INFO - ###########all tables
2024-10-26 01:25:49,233 - INFO - ######Batch loading from finance_insights_int to finance_insights_wrk in Progress !!
2024-10-26 01:25:49,233 - INFO - Fetching all the tables from current schema  : finance_insights_int 
2024-10-26 01:25:49,233 - INFO - [('june_2024',), ('april_2024',), ('may_2024',), ('september_2024',), ('july_2024',), ('august_2024',), ('october_2024',), ('november_2024',)]
2024-10-26 01:25:49,233 - INFO - Storing the views in a temp layer 
2024-10-26 01:25:49,253 - INFO - Droping the views for proper data load to wrk 
2024-10-26 01:25:49,256 - INFO - #############################
2024-10-26 01:25:49,258 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,259 - INFO - Table finance_insights_wrk.june_2024 already exists !! 
2024-10-26 01:25:49,259 - INFO - Dropping off the table
2024-10-26 01:25:49,260 - INFO - Creating ddl for finance_insights_wrk.june_2024
2024-10-26 01:25:49,271 - INFO - Target table : finance_insights_wrk.june_2024 created successfully !!
2024-10-26 01:25:49,272 - INFO - Data copied from finance_insights_int.june_2024 to finance_insights_wrk.june_2024 successful!!!
2024-10-26 01:25:49,272 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,272 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,278 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,284 - INFO - Changes made successfully!!
2024-10-26 01:25:49,284 - INFO - #############################
2024-10-26 01:25:49,285 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,285 - INFO - Table finance_insights_wrk.april_2024 already exists !! 
2024-10-26 01:25:49,285 - INFO - Dropping off the table
2024-10-26 01:25:49,287 - INFO - Creating ddl for finance_insights_wrk.april_2024
2024-10-26 01:25:49,295 - INFO - Target table : finance_insights_wrk.april_2024 created successfully !!
2024-10-26 01:25:49,296 - INFO - Data copied from finance_insights_int.april_2024 to finance_insights_wrk.april_2024 successful!!!
2024-10-26 01:25:49,296 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,296 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,303 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,307 - INFO - Changes made successfully!!
2024-10-26 01:25:49,307 - INFO - #############################
2024-10-26 01:25:49,308 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,310 - INFO - Table finance_insights_wrk.may_2024 already exists !! 
2024-10-26 01:25:49,310 - INFO - Dropping off the table
2024-10-26 01:25:49,310 - INFO - Creating ddl for finance_insights_wrk.may_2024
2024-10-26 01:25:49,320 - INFO - Target table : finance_insights_wrk.may_2024 created successfully !!
2024-10-26 01:25:49,321 - INFO - Data copied from finance_insights_int.may_2024 to finance_insights_wrk.may_2024 successful!!!
2024-10-26 01:25:49,321 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,321 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,330 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,334 - INFO - Changes made successfully!!
2024-10-26 01:25:49,334 - INFO - #############################
2024-10-26 01:25:49,337 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,338 - INFO - Table finance_insights_wrk.september_2024 already exists !! 
2024-10-26 01:25:49,338 - INFO - Dropping off the table
2024-10-26 01:25:49,338 - INFO - Creating ddl for finance_insights_wrk.september_2024
2024-10-26 01:25:49,347 - INFO - Target table : finance_insights_wrk.september_2024 created successfully !!
2024-10-26 01:25:49,348 - INFO - Data copied from finance_insights_int.september_2024 to finance_insights_wrk.september_2024 successful!!!
2024-10-26 01:25:49,349 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,349 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,354 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,359 - INFO - Changes made successfully!!
2024-10-26 01:25:49,359 - INFO - #############################
2024-10-26 01:25:49,361 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,361 - INFO - Table finance_insights_wrk.july_2024 already exists !! 
2024-10-26 01:25:49,361 - INFO - Dropping off the table
2024-10-26 01:25:49,362 - INFO - Creating ddl for finance_insights_wrk.july_2024
2024-10-26 01:25:49,372 - INFO - Target table : finance_insights_wrk.july_2024 created successfully !!
2024-10-26 01:25:49,374 - INFO - Data copied from finance_insights_int.july_2024 to finance_insights_wrk.july_2024 successful!!!
2024-10-26 01:25:49,374 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,374 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,380 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,384 - INFO - Changes made successfully!!
2024-10-26 01:25:49,384 - INFO - #############################
2024-10-26 01:25:49,386 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,386 - INFO - Table finance_insights_wrk.august_2024 already exists !! 
2024-10-26 01:25:49,386 - INFO - Dropping off the table
2024-10-26 01:25:49,387 - INFO - Creating ddl for finance_insights_wrk.august_2024
2024-10-26 01:25:49,396 - INFO - Target table : finance_insights_wrk.august_2024 created successfully !!
2024-10-26 01:25:49,397 - INFO - Data copied from finance_insights_int.august_2024 to finance_insights_wrk.august_2024 successful!!!
2024-10-26 01:25:49,397 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,397 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,403 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,409 - INFO - Changes made successfully!!
2024-10-26 01:25:49,409 - INFO - #############################
2024-10-26 01:25:49,410 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,411 - INFO - Table finance_insights_wrk.october_2024 already exists !! 
2024-10-26 01:25:49,411 - INFO - Dropping off the table
2024-10-26 01:25:49,411 - INFO - Creating ddl for finance_insights_wrk.october_2024
2024-10-26 01:25:49,421 - INFO - Target table : finance_insights_wrk.october_2024 created successfully !!
2024-10-26 01:25:49,423 - INFO - Data copied from finance_insights_int.october_2024 to finance_insights_wrk.october_2024 successful!!!
2024-10-26 01:25:49,423 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,424 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,430 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,435 - INFO - Changes made successfully!!
2024-10-26 01:25:49,436 - INFO - #############################
2024-10-26 01:25:49,437 - INFO - Checking if the target table already exists : 
2024-10-26 01:25:49,439 - INFO - Table finance_insights_wrk.november_2024 already exists !! 
2024-10-26 01:25:49,440 - INFO - Dropping off the table
2024-10-26 01:25:49,440 - INFO - Creating ddl for finance_insights_wrk.november_2024
2024-10-26 01:25:49,451 - INFO - Target table : finance_insights_wrk.november_2024 created successfully !!
2024-10-26 01:25:49,452 - INFO - Data copied from finance_insights_int.november_2024 to finance_insights_wrk.november_2024 successful!!!
2024-10-26 01:25:49,452 - INFO - Temp table for file_nm insertion
2024-10-26 01:25:49,452 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:25:49,459 - INFO - file_nm insertion successfull
2024-10-26 01:25:49,464 - INFO - Changes made successfully!!
2024-10-26 01:25:49,464 - INFO - Recreating all the views !!
2024-10-26 01:25:58,177 - INFO - ###############
2024-10-26 01:25:58,177 - INFO - SQL TO EXCEL in Progress
2024-10-26 01:25:58,353 - INFO - DB Connected for SQL to Excel conversion.
2024-10-26 01:25:58,370 - INFO - Query 1 data written to Savings Rate.
2024-10-26 01:25:58,382 - INFO - Query 2 data written to Recurring vs Non-Recurring.
2024-10-26 01:25:58,421 - INFO - Query 3 data written to Expense Efficiency.
2024-10-26 01:25:58,426 - INFO - Query 4 data written to Highest Daily Expense.
2024-10-26 01:25:58,429 - INFO - Query 5 data written to Lowest Daily Expense.
2024-10-26 01:25:58,433 - INFO - Query 6 data written to Weekly Expense Analysis.
2024-10-26 01:25:58,439 - INFO - Query 7 data written to Unexpected Expenses.
2024-10-26 01:25:58,452 - INFO - Query 8 data written to Daily Spending Variance.
2024-10-26 01:25:58,467 - INFO - Query 9 data written to Opportunity Cost Analysis.
2024-10-26 01:25:58,473 - INFO - Query 10 data written to Psychological Spending.
2024-10-26 01:25:58,487 - INFO - Query 11 data written to Needs Wants Investments.
2024-10-26 01:25:58,493 - INFO - No data returned for query 12.
2024-10-26 01:25:58,496 - INFO - Query 13 data written to 1st 15 Days vs Last 15 Days.
2024-10-26 01:25:58,502 - INFO - Query 14 data written to Max Expense Category.
2024-10-26 01:25:58,506 - INFO - Query 15 data written to Top N Expense Categories.
2024-10-26 01:25:58,515 - INFO - Query 16 data written to Weekdays vs Weekends.
2024-10-26 01:25:58,523 - INFO - Query 17 data written to Category-wise.
2024-10-26 01:25:58,550 - INFO - Error executing SQL query: -- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.
Execution failed on sql '-- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.': can't execute an empty query
2024-10-26 01:25:58,550 - INFO - No data returned for query 18.
2024-10-26 01:25:58,772 - INFO - Database connection closed.
2024-10-26 01:25:58,772 - INFO - Data export completed. Check the file: REPORTS/August_2024_REPORT.xlsx
2024-10-26 01:26:11,627 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:26:11,628 - INFO - ###############
2024-10-26 01:26:11,628 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:26:11,628 - INFO - Data Integration from finance_insights_stg to finance_insights_int is in progress
2024-10-26 01:26:11,692 - INFO - ###########all tables
2024-10-26 01:26:11,701 - INFO - ######Batch loading from finance_insights_stg to finance_insights_int in Progress !!
2024-10-26 01:26:11,701 - INFO - Fetching all the tables from current schema  : finance_insights_stg 
2024-10-26 01:26:11,701 - INFO - [('november_2024',), ('april_2024',), ('may_2024',), ('june_2024',), ('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',)]
2024-10-26 01:26:11,701 - INFO - #############################
2024-10-26 01:26:11,702 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,703 - INFO - Table finance_insights_int.november_2024 already exists !! 
2024-10-26 01:26:11,703 - INFO - Dropping off the table
2024-10-26 01:26:11,706 - INFO - Creating ddl for finance_insights_int.november_2024
2024-10-26 01:26:11,718 - INFO - #############################
2024-10-26 01:26:11,721 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,722 - INFO - Table finance_insights_int.april_2024 already exists !! 
2024-10-26 01:26:11,722 - INFO - Dropping off the table
2024-10-26 01:26:11,722 - INFO - Creating ddl for finance_insights_int.april_2024
2024-10-26 01:26:11,731 - INFO - Target table : finance_insights_int.april_2024 created successfully !!
2024-10-26 01:26:11,732 - INFO - Data copied from finance_insights_stg.april_2024 to finance_insights_int.april_2024 successful!!!
2024-10-26 01:26:11,732 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,732 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,740 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,747 - INFO - Changes made successfully!!
2024-10-26 01:26:11,747 - INFO - #############################
2024-10-26 01:26:11,749 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,750 - INFO - Table finance_insights_int.may_2024 already exists !! 
2024-10-26 01:26:11,750 - INFO - Dropping off the table
2024-10-26 01:26:11,751 - INFO - Creating ddl for finance_insights_int.may_2024
2024-10-26 01:26:11,761 - INFO - Target table : finance_insights_int.may_2024 created successfully !!
2024-10-26 01:26:11,762 - INFO - Data copied from finance_insights_stg.may_2024 to finance_insights_int.may_2024 successful!!!
2024-10-26 01:26:11,762 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,762 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,769 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,774 - INFO - Changes made successfully!!
2024-10-26 01:26:11,774 - INFO - #############################
2024-10-26 01:26:11,775 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,776 - INFO - Table finance_insights_int.june_2024 already exists !! 
2024-10-26 01:26:11,777 - INFO - Dropping off the table
2024-10-26 01:26:11,777 - INFO - Creating ddl for finance_insights_int.june_2024
2024-10-26 01:26:11,789 - INFO - Target table : finance_insights_int.june_2024 created successfully !!
2024-10-26 01:26:11,791 - INFO - Data copied from finance_insights_stg.june_2024 to finance_insights_int.june_2024 successful!!!
2024-10-26 01:26:11,791 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,791 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,796 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,801 - INFO - Changes made successfully!!
2024-10-26 01:26:11,801 - INFO - #############################
2024-10-26 01:26:11,802 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,803 - INFO - Table finance_insights_int.july_2024 already exists !! 
2024-10-26 01:26:11,803 - INFO - Dropping off the table
2024-10-26 01:26:11,804 - INFO - Creating ddl for finance_insights_int.july_2024
2024-10-26 01:26:11,812 - INFO - Target table : finance_insights_int.july_2024 created successfully !!
2024-10-26 01:26:11,814 - INFO - Data copied from finance_insights_stg.july_2024 to finance_insights_int.july_2024 successful!!!
2024-10-26 01:26:11,814 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,814 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,820 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,825 - INFO - Changes made successfully!!
2024-10-26 01:26:11,825 - INFO - #############################
2024-10-26 01:26:11,827 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,828 - INFO - Table finance_insights_int.august_2024 already exists !! 
2024-10-26 01:26:11,828 - INFO - Dropping off the table
2024-10-26 01:26:11,828 - INFO - Creating ddl for finance_insights_int.august_2024
2024-10-26 01:26:11,837 - INFO - Target table : finance_insights_int.august_2024 created successfully !!
2024-10-26 01:26:11,838 - INFO - Data copied from finance_insights_stg.august_2024 to finance_insights_int.august_2024 successful!!!
2024-10-26 01:26:11,839 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,839 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,846 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,850 - INFO - Changes made successfully!!
2024-10-26 01:26:11,850 - INFO - #############################
2024-10-26 01:26:11,852 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,852 - INFO - Table finance_insights_int.september_2024 already exists !! 
2024-10-26 01:26:11,852 - INFO - Dropping off the table
2024-10-26 01:26:11,853 - INFO - Creating ddl for finance_insights_int.september_2024
2024-10-26 01:26:11,863 - INFO - Target table : finance_insights_int.september_2024 created successfully !!
2024-10-26 01:26:11,864 - INFO - Data copied from finance_insights_stg.september_2024 to finance_insights_int.september_2024 successful!!!
2024-10-26 01:26:11,864 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,864 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,871 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,876 - INFO - Changes made successfully!!
2024-10-26 01:26:11,876 - INFO - #############################
2024-10-26 01:26:11,877 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:11,878 - INFO - Table finance_insights_int.october_2024 already exists !! 
2024-10-26 01:26:11,878 - INFO - Dropping off the table
2024-10-26 01:26:11,879 - INFO - Creating ddl for finance_insights_int.october_2024
2024-10-26 01:26:11,887 - INFO - Target table : finance_insights_int.october_2024 created successfully !!
2024-10-26 01:26:11,889 - INFO - Data copied from finance_insights_stg.october_2024 to finance_insights_int.october_2024 successful!!!
2024-10-26 01:26:11,889 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:11,889 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:11,896 - INFO - file_nm insertion successfull
2024-10-26 01:26:11,900 - INFO - Changes made successfully!!
2024-10-26 01:26:19,159 - INFO - Current working directory is: C:\Users\shogu\OneDrive\Desktop\Data Engineering\FY_Data_analysis
2024-10-26 01:26:19,159 - INFO - ###############
2024-10-26 01:26:19,159 - INFO - ############ Data Loding in Progress ##############
2024-10-26 01:26:19,159 - INFO - Data Integration from finance_insights_int to finance_insights_wrk is in progress
2024-10-26 01:26:19,233 - INFO - ###########all tables
2024-10-26 01:26:19,242 - INFO - ######Batch loading from finance_insights_int to finance_insights_wrk in Progress !!
2024-10-26 01:26:19,242 - INFO - Fetching all the tables from current schema  : finance_insights_int 
2024-10-26 01:26:19,242 - INFO - [('april_2024',), ('june_2024',), ('may_2024',), ('july_2024',), ('august_2024',), ('september_2024',), ('october_2024',), ('november_2024',)]
2024-10-26 01:26:19,242 - INFO - Storing the views in a temp layer 
2024-10-26 01:26:19,261 - INFO - Droping the views for proper data load to wrk 
2024-10-26 01:26:19,263 - INFO - #############################
2024-10-26 01:26:19,264 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,265 - INFO - Table finance_insights_wrk.april_2024 already exists !! 
2024-10-26 01:26:19,265 - INFO - Dropping off the table
2024-10-26 01:26:19,266 - INFO - Creating ddl for finance_insights_wrk.april_2024
2024-10-26 01:26:19,276 - INFO - Target table : finance_insights_wrk.april_2024 created successfully !!
2024-10-26 01:26:19,278 - INFO - Data copied from finance_insights_int.april_2024 to finance_insights_wrk.april_2024 successful!!!
2024-10-26 01:26:19,278 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,278 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,284 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,289 - INFO - Changes made successfully!!
2024-10-26 01:26:19,289 - INFO - #############################
2024-10-26 01:26:19,291 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,292 - INFO - Table finance_insights_wrk.june_2024 already exists !! 
2024-10-26 01:26:19,292 - INFO - Dropping off the table
2024-10-26 01:26:19,292 - INFO - Creating ddl for finance_insights_wrk.june_2024
2024-10-26 01:26:19,300 - INFO - Target table : finance_insights_wrk.june_2024 created successfully !!
2024-10-26 01:26:19,301 - INFO - Data copied from finance_insights_int.june_2024 to finance_insights_wrk.june_2024 successful!!!
2024-10-26 01:26:19,302 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,302 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,309 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,314 - INFO - Changes made successfully!!
2024-10-26 01:26:19,314 - INFO - #############################
2024-10-26 01:26:19,315 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,316 - INFO - Table finance_insights_wrk.may_2024 already exists !! 
2024-10-26 01:26:19,316 - INFO - Dropping off the table
2024-10-26 01:26:19,317 - INFO - Creating ddl for finance_insights_wrk.may_2024
2024-10-26 01:26:19,325 - INFO - Target table : finance_insights_wrk.may_2024 created successfully !!
2024-10-26 01:26:19,326 - INFO - Data copied from finance_insights_int.may_2024 to finance_insights_wrk.may_2024 successful!!!
2024-10-26 01:26:19,326 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,326 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,334 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,339 - INFO - Changes made successfully!!
2024-10-26 01:26:19,339 - INFO - #############################
2024-10-26 01:26:19,340 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,340 - INFO - Table finance_insights_wrk.july_2024 already exists !! 
2024-10-26 01:26:19,341 - INFO - Dropping off the table
2024-10-26 01:26:19,341 - INFO - Creating ddl for finance_insights_wrk.july_2024
2024-10-26 01:26:19,349 - INFO - Target table : finance_insights_wrk.july_2024 created successfully !!
2024-10-26 01:26:19,351 - INFO - Data copied from finance_insights_int.july_2024 to finance_insights_wrk.july_2024 successful!!!
2024-10-26 01:26:19,351 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,351 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,359 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,364 - INFO - Changes made successfully!!
2024-10-26 01:26:19,364 - INFO - #############################
2024-10-26 01:26:19,365 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,366 - INFO - Table finance_insights_wrk.august_2024 already exists !! 
2024-10-26 01:26:19,366 - INFO - Dropping off the table
2024-10-26 01:26:19,366 - INFO - Creating ddl for finance_insights_wrk.august_2024
2024-10-26 01:26:19,377 - INFO - Target table : finance_insights_wrk.august_2024 created successfully !!
2024-10-26 01:26:19,378 - INFO - Data copied from finance_insights_int.august_2024 to finance_insights_wrk.august_2024 successful!!!
2024-10-26 01:26:19,378 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,379 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,386 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,391 - INFO - Changes made successfully!!
2024-10-26 01:26:19,391 - INFO - #############################
2024-10-26 01:26:19,392 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,393 - INFO - Table finance_insights_wrk.september_2024 already exists !! 
2024-10-26 01:26:19,393 - INFO - Dropping off the table
2024-10-26 01:26:19,394 - INFO - Creating ddl for finance_insights_wrk.september_2024
2024-10-26 01:26:19,402 - INFO - Target table : finance_insights_wrk.september_2024 created successfully !!
2024-10-26 01:26:19,403 - INFO - Data copied from finance_insights_int.september_2024 to finance_insights_wrk.september_2024 successful!!!
2024-10-26 01:26:19,404 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,404 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,412 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,416 - INFO - Changes made successfully!!
2024-10-26 01:26:19,416 - INFO - #############################
2024-10-26 01:26:19,418 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,419 - INFO - Table finance_insights_wrk.october_2024 already exists !! 
2024-10-26 01:26:19,419 - INFO - Dropping off the table
2024-10-26 01:26:19,419 - INFO - Creating ddl for finance_insights_wrk.october_2024
2024-10-26 01:26:19,429 - INFO - Target table : finance_insights_wrk.october_2024 created successfully !!
2024-10-26 01:26:19,430 - INFO - Data copied from finance_insights_int.october_2024 to finance_insights_wrk.october_2024 successful!!!
2024-10-26 01:26:19,430 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,430 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,437 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,441 - INFO - Changes made successfully!!
2024-10-26 01:26:19,441 - INFO - #############################
2024-10-26 01:26:19,442 - INFO - Checking if the target table already exists : 
2024-10-26 01:26:19,444 - INFO - Table finance_insights_wrk.november_2024 already exists !! 
2024-10-26 01:26:19,444 - INFO - Dropping off the table
2024-10-26 01:26:19,444 - INFO - Creating ddl for finance_insights_wrk.november_2024
2024-10-26 01:26:19,454 - INFO - Target table : finance_insights_wrk.november_2024 created successfully !!
2024-10-26 01:26:19,455 - INFO - Data copied from finance_insights_int.november_2024 to finance_insights_wrk.november_2024 successful!!!
2024-10-26 01:26:19,455 - INFO - Temp table for file_nm insertion
2024-10-26 01:26:19,455 - INFO - Checking if the temp target table already exists : 
2024-10-26 01:26:19,462 - INFO - file_nm insertion successfull
2024-10-26 01:26:19,467 - INFO - Changes made successfully!!
2024-10-26 01:26:19,468 - INFO - Recreating all the views !!
2024-10-26 01:26:27,827 - INFO - ###############
2024-10-26 01:26:27,827 - INFO - SQL TO EXCEL in Progress
2024-10-26 01:26:27,922 - INFO - DB Connected for SQL to Excel conversion.
2024-10-26 01:26:27,945 - INFO - Query 1 data written to Savings Rate.
2024-10-26 01:26:27,959 - INFO - Query 2 data written to Recurring vs Non-Recurring.
2024-10-26 01:26:28,039 - INFO - Query 3 data written to Expense Efficiency.
2024-10-26 01:26:28,047 - INFO - Query 4 data written to Highest Daily Expense.
2024-10-26 01:26:28,052 - INFO - Query 5 data written to Lowest Daily Expense.
2024-10-26 01:26:28,058 - INFO - Query 6 data written to Weekly Expense Analysis.
2024-10-26 01:26:28,065 - INFO - Query 7 data written to Unexpected Expenses.
2024-10-26 01:26:28,077 - INFO - Query 8 data written to Daily Spending Variance.
2024-10-26 01:26:28,102 - INFO - Query 9 data written to Opportunity Cost Analysis.
2024-10-26 01:26:28,112 - INFO - Query 10 data written to Psychological Spending.
2024-10-26 01:26:28,131 - INFO - Query 11 data written to Needs Wants Investments.
2024-10-26 01:26:28,144 - INFO - Query 12 data written to Pending Payments.
2024-10-26 01:26:28,166 - INFO - Query 13 data written to 1st 15 Days vs Last 15 Days.
2024-10-26 01:26:28,173 - INFO - Query 14 data written to Max Expense Category.
2024-10-26 01:26:28,179 - INFO - Query 15 data written to Top N Expense Categories.
2024-10-26 01:26:28,191 - INFO - Query 16 data written to Weekdays vs Weekends.
2024-10-26 01:26:28,201 - INFO - Query 17 data written to Category-wise.
2024-10-26 01:26:28,235 - INFO - Error executing SQL query: -- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.
Execution failed on sql '-- To Be Analyzed:
-- Quarterly Analysis: High-Frequency Categories
-- Identify categories that frequently appear in daily expenses and analyze their contribution to overall spending.': can't execute an empty query
2024-10-26 01:26:28,238 - INFO - No data returned for query 18.
2024-10-26 01:26:28,466 - INFO - Database connection closed.
2024-10-26 01:26:28,466 - INFO - Data export completed. Check the file: REPORTS/July_2024_REPORT.xlsx
